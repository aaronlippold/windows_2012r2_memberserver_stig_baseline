name: windows_2012r2_memberserver_stig
title: Windows 2012r2 Member Server STIG
maintainer: The MITRE Corporation
copyright: The MITRE Corporation
copyright_email: inspec@mitre.org
license: Apache-2.0
summary: Inspec profile testing STIG compliance of Windows Member Server 2012r2
description:
  Inspec testing for Windows 2012r2 member servers per the IASE DISA Windows
  2012r2 v2r12 STIG at 
  https://iasecontent.disa.mil/stigs/zip/U_Windows_2012_and_2012_R2_MS_V2R12_STIG.zip
version: 0.1.0

inputs:
  - name: av_approved_software
    desc: "This is a list of Approved Anti-Virus Software"
    type: Array
    value:
      - Windows Defender
      - McAfee Host Intrusion Prevention
      - McAfee Endpoint Security
      - McAfee Agent

  - name: shared_accounts
    type: array
    description: 'List of shared accounts on the system'
    default: []

  - name: backup_operators
    type: array
    description: 'List of authorized users in the Backup Operators Group'
    default: []

  - name: administrators
    type: array
    description: 'List of authorized users in the local Administrators group'
    default: []
    
  - name: administrators_domain'
    type: array
    description: 'List of authorized users in the local Administrators domain group'
    default: []

  - name: temp_account
    type: array
    description: 'List of temporary accounts on the system'
    default: []

  - name: emergency_account
    type: array
    description: 'List of emergency accounts on the system'
    default: []

  - name: LegalNoticeText
    type: string
    default: "You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.
    By using this IS (which includes any device attached to this IS), you consent
    to the following conditions:
    -The USG routinely intercepts and monitors communications on this IS for
    purposes including, but not limited to, penetration testing, COMSEC monitoring,
    network operations and defense, personnel misconduct (PM), law enforcement
    (LE), and counterintelligence (CI) investigations.
    -At any time, the USG may inspect and seize data stored on this IS.
    -Communications using, or data stored on, this IS are not private, are subject
    to routine monitoring, interception, and search, and may be disclosed or used
    for any USG-authorized purpose.
    -This IS includes security measures (e.g., authentication and access controls)
    to protect USG interests--not for your personal benefit or privacy.
    -Notwithstanding the above, using this IS does not constitute consent to PM, LE
    or CI investigative searching or monitoring of the content of privileged
    communications, or work product, related to personal representation or services
    by attorneys, psychotherapists, or clergy, and their assistants.  Such
    communications and work product are private and confidential.  See User
    Agreement for details."

  - name: LegalNoticeCaption
    type: string
    default: "DoD Notice and Consent Banner, US Department of Defense Warning Statement, or a site-defined equivalent."

  - name: reg_winreg_perms
    desc: 'This is the values of the winreg registry key'
    type: Array
    value:
     - NT AUTHORITY\LOCAL SERVICE Allow  -2147483648
     - NT AUTHORITY\LOCAL SERVICE Allow  ReadKey
     - BUILTIN\Administrators Allow  268435456
     - BUILTIN\Administrators Allow  FullControl
     - BUILTIN\Backup Operators Allow  ReadKey

  - name: domain_sid
    desc: 'This is the SID for Domain'
    type: String
    value: "3561952647-5207400-2818715555"

  - name: dod_root_certificates
    desc: "List of DoD CA Root Certificates"
    type: Array
    value: 
     - :Subject: "CN=DoD Root CA 2, OU=PKI, OU=DoD, O=U.S. Government, C=US"
       :Thumbprint: "8C941B34EA1EA6ED9AE2BC54CF687252B4C9B561"
       :NotAfter: "Wednesday, December 05, 2029"
     - :Subject: "CN=DoD Root CA 3, OU=PKI, OU=DoD, O=U.S. Government, C=US"
       :Thumbprint: "D73CA91102A2204A36459ED32213B467D7CE97FB"
       :NotAfter: "Sunday, December 30, 2029"
     - :Subject: "CN=DoD Root CA 4, OU=PKI, OU=DoD, O=U.S. Government, C=US"
       :Thumbprint: "B8269F25DBD937ECAFD4C35A9838571723F2D026"
       :NotAfter: "Sunday, July 25, 2032"
     - :Subject: "CN=DoD Root CA 5, OU=PKI, OU=DoD, O=U.S. Government, C=US"
       :Thumbprint: "4ECB5CC3095670454DA1CBD410FC921F46B8564B"
       :NotAfter: "Friday, June 14, 2041"

  - name: dod_interoperability_certificates
    desc: "List of DoD CA Root Certificates"
    type: Array
    value: 
     - :Subject: "CN=DoD Root CA 2, OU=PKI, OU=DoD, O=U.S. Government, C=US"
       :Issuer: "CN=DoD Interoperability Root CA 1, OU=PKI, OU=DoD, O=U.S. Government, C=US"
       :Thumbprint: "22BBE981F0694D246CC1472ED2B021DC8540A22F"
       :NotAfter: "Friday, September 6, 2019"
     - :Subject: "CN=DoD Root CA 3, OU=PKI, OU=DoD, O=U.S. Government, C=US"
       :Issuer: "CN=DoD Interoperability Root CA 2, OU=PKI, OU=DoD, O=U.S. Government, C=US"
       :Thumbprint: "AC06108CA348CC03B53795C64BF84403C1DBD341"
       :NotAfter: "Saturday, January 22, 2022"

  - name: dod_cceb_certificates
    desc: "List of CCEB Certificates"
    type: Array
    value: 
     - :Subject: "CN=DoD Root CA 3, OU=PKI, OU=DoD, O=U.S. Government, C=US"
       :Issuer: "CN=US DoD CCEB Interoperability Root CA 2, OU=PKI, OU=DoD, O=U.S. Government, C=US"
       :Thumbprint: "929BF3196896994C0A201DF4A5B71F603FEFBF2E"
       :NotAfter: "Friday, September 27, 2019"
  
  - name: sensitive_system
    desc: "Set flag to true if the target system is sensitive"
    type: String
    value: "false"

  - name: reg_install_comp_perms
    desc: 'This is the values of the Installed Components registry key'
    type: Array
    value:
    - BUILTIN\Users Allow  ReadKey
    - BUILTIN\Users Allow  -2147483648
    - BUILTIN\Administrators Allow  FullControl
    - BUILTIN\Administrators Allow  268435456
    - NT AUTHORITY\SYSTEM Allow  FullControl
    - NT AUTHORITY\SYSTEM Allow  268435456
    - CREATOR OWNER Allow  268435456
    - APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES Allow  ReadKey
    - APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES Allow  -2147483648

  - name: reg_wow6432_install_comp_perms
    desc: 'This is the values of the Installed Components under WoW643Node registry key'
    type: Array
    value:
    - BUILTIN\Users Allow  ReadKey
    - BUILTIN\Administrators Allow  FullControl
    - NT AUTHORITY\SYSTEM Allow  FullControl
    - CREATOR OWNER Allow  FullControl
    - APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES Allow  ReadKey

  - name: winevt_logs_application_perms
    desc: 'This is the values of the Application.evtx file under system32'
    type: Array
    value:
    - NT SERVICE\EventLog Allow  FullControl
    - NT AUTHORITY\SYSTEM Allow  FullControl
    - BUILTIN\Administrators Allow  FullControl

  - name: winevt_logs_security_perms
    desc: 'This is the values of the Security.evtx file under system32'
    type: Array
    value:
    - NT SERVICE\EventLog Allow  FullControl
    - NT AUTHORITY\SYSTEM Allow  FullControl
    - BUILTIN\Administrators Allow  FullControl

  - name: winevt_logs_system_perms
    desc: 'This is the values of the System.evtx file under system32'
    type: Array
    value:
    - NT SERVICE\EventLog Allow  FullControl
    - NT AUTHORITY\SYSTEM Allow  FullControl
    - BUILTIN\Administrators Allow  FullControl

  - name: eventvwr_perms
    desc: 'This is the values of the Eventvwr.exe file under system32'
    type: Array
    value:
    - NT AUTHORITY\SYSTEM Allow  ReadAndExecute, Synchronize
    - BUILTIN\Administrators Allow  ReadAndExecute, Synchronize
    - BUILTIN\Users Allow  ReadAndExecute, Synchronize
    - NT SERVICE\TrustedInstaller Allow  FullControl
    - APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES Allow  ReadAndExecute, Synchronize